# Web界面快速开始

## 🚀 启动Web服务

### 方式1：带Web界面启动
```bash
./process-tracker start --web
```

启动后会显示所有可访问的内网IP地址：
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🌐 Web服务器已启动，可通过以下地址访问：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  http://192.168.1.102:18080
  http://192.168.1.105:18080
  http://100.65.159.9:18080
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 方式2：修改默认端口
```bash
./process-tracker start --web --web-port 8080
```

### 方式3：配置文件
编辑 `~/.process-tracker/config.yaml`:
```yaml
web:
  enabled: true
  host: "0.0.0.0"    # 监听所有网卡
  port: "18080"       # Web端口
```

然后启动：
```bash
./process-tracker start
```

---

## 🎨 Web界面功能

### 仪表板概览
- **活跃进程**: 当前活跃的进程数量
- **平均CPU (归一化)**: 0-100%表示系统整体CPU使用率
  - 例如：72核系统，1.39%表示使用了1个核心
- **进程总内存**: 显示MB和百分比
  - 例如：24GB (7.52%)
- **系统状态**: 根据CPU负载自动判断（正常/中等/高负载）

### CPU使用率趋势
- 实时更新的折线图
- 显示归一化CPU（0-100%）
- Y轴带百分号，范围0-100%
- Tooltip显示精确值

### 内存使用趋势
- 实时更新的折线图
- 显示内存占系统百分比
- Y轴范围0-100%
- 直观反映内存压力

### 进程列表
功能：
- 🔍 **搜索框**: 实时搜索进程名/命令
- 🏷️ **分类过滤**:
  - 全部进程
  - 🐳 Docker容器
  - 💻 开发工具
  - 🌐 浏览器
- 📊 **排序**: 点击列标题按CPU/内存/PID排序
- ♻️ **自动刷新**: 每5秒自动更新数据

显示信息：
- PID
- 进程名
- CPU使用率（归一化百分比）
- 内存使用（MB + 百分比）
- 状态（活跃/空闲）

---

## 🎛️ 进程管理

### 查看状态
```bash
./process-tracker status
```

输出示例：
```
📊 Process Tracker 状态
━━━━━━━━━━━━━━━━━━━━━━━━━━
状态: 🟢 运行中
PID:  12345
数据: 15.23 MB
更新: 2025-01-15 10:30:45
```

### 停止服务
```bash
./process-tracker stop
```

特性：
- 发送SIGTERM信号
- 等待优雅关闭（最多5秒）
- 超时提示强制终止命令

### 重启服务
```bash
./process-tracker restart --web
```

等价于：
```bash
./process-tracker stop
./process-tracker start --web
```

---

## 🔧 常见问题

### Q1: 无法访问Web界面？
**检查清单**：
1. 确认进程正在运行：`./process-tracker status`
2. 检查防火墙是否开放18080端口
3. 尝试使用localhost访问：`http://localhost:18080`
4. 查看日志：`tail -f ~/.process-tracker/process-tracker.log`

### Q2: CPU显示为什么这么低？
**答**：现在使用归一化CPU（0-100%表示整个系统）。

例如在72核系统：
- 单进程100% CPU → 显示1.39% (100÷72)
- 8进程各100% CPU → 显示11.11% (800÷72)

这样更直观地反映系统整体负载。

### Q3: 内存百分比是什么意思？
**答**：进程使用内存 ÷ 系统总内存 × 100%

例如：
- 系统总内存：322GB
- 进程使用：24GB
- 显示：24GB (7.52%)

### Q4: Stop命令hang住不动？
**答**：已修复！现在：
- 最多等待5秒
- 超时后提示强制终止命令
- 优雅关闭机制确保数据完整

### Q5: Docker容器监控不显示？
**答**：检查：
1. Docker是否安装：`docker --version`
2. 用户是否在docker组：`groups $USER`
3. Docker服务是否运行：`systemctl status docker`
4. 配置文件启用Docker监控（默认启用）

---

## 📊 Web界面技术说明

### CPU归一化原理
```
原始CPU = 进程实际CPU使用率（可>100%）
归一化CPU = 原始CPU ÷ 系统总核心数

Web显示：
- 统计卡片：归一化CPU
- 趋势图：归一化CPU
- 进程列表：归一化CPU
```

### 内存百分比计算
```
内存百分比 = (进程内存MB ÷ 系统总内存MB) × 100%

Web显示：
- 统计卡片：24GB (7.52%)
- 进程列表：512MB (0.16%)
```

### 数据刷新机制
- **统计数据**: 每5秒刷新（平均CPU、总内存等）
- **进程列表**: 每5秒刷新（保留用户的搜索/排序/过滤状态）
- **趋势图**: 每5秒添加新数据点
- **时间窗口**: 默认显示1小时数据

### 性能优化
- 客户端缓存：5秒TTL
- 客户端过滤：搜索和分类在前端处理，无服务器负载
- 无动画更新：图表使用`update('none')`，流畅刷新
- 分离逻辑：统计和进程列表独立刷新

---

## 🎯 使用建议

### 日常监控
1. 启动Web界面：`./process-tracker start --web`
2. 在浏览器中添加书签
3. 定期查看Dashboard了解系统状态

### 问题排查
1. 使用搜索框快速定位进程
2. 按内存/CPU排序找出资源占用大户
3. 查看趋势图了解资源使用模式
4. 使用Docker过滤排查容器问题

### 性能调优
1. 观察"平均CPU (归一化)"
   - <50%：正常
   - 50-80%：需关注
   - >80%：需要优化
2. 观察"进程总内存"百分比
   - <60%：充足
   - 60-80%：适中
   - >80%：内存压力大

### 最佳实践
- ✅ 使用Web界面实时监控
- ✅ 使用CLI命令生成历史报告
- ✅ 定期导出数据备份：`./process-tracker export`
- ✅ 配置合理的数据保留期：`keep_days: 7`
- ✅ 启用Docker监控了解容器资源

---

## 📱 移动端访问

Web界面响应式设计，支持移动设备访问：
- 手机浏览器直接访问内网IP
- 布局自动适配屏幕尺寸
- 触摸友好的交互设计

---

**快速访问Web界面，实时掌握系统状态！** 🎉
