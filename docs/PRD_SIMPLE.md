# Process Tracker - 简化版PRD

## 核心目标
开发一个Go语言程序，监控Linux服务器上进程的使用时间，生成日报/周报/月报。

## 目标用户
- 个人开发者
- 系统管理员  
- 需要了解软件使用情况的用户

## MVP功能清单

### 1. 进程监控 (main.go - 400行)
- **CLI接口** (80行)
  - start/stop/status命令
  - today/week/month报告
  - 简单的参数解析
  
- **监控循环** (120行)
  - 定时扫描进程 (5秒间隔)
  - 数据收集和预处理
  - 优雅退出处理
  
- **报告生成** (200行)
  - 今日使用时间统计
  - 本周使用时间汇总  
  - 本月使用时间趋势
  - 格式化输出

### 2. 进程信息处理 (monitor.go - 300行)
- **进程数据结构** (50行)
  - ProcessRecord定义
  - 时间戳处理
  - 数据验证
  
- **进程信息获取** (100行)
  - 使用gopsutil库
  - 过滤系统进程
  - 提取关键信息
  
- **应用分类** (150行)
  - 内置分类规则
  - 开发/浏览器/系统工具识别
  - 自定义分类支持

### 3. 数据存储 (storage.go - 200行)
- **数据库初始化** (60行)
  - SQLite连接管理
  - 表结构创建
  - 错误处理
  
- **数据操作** (80行)
  - 进程数据保存
  - 批量插入优化
  - 数据清理机制
  
- **查询统计** (60行)
  - 时间范围查询
  - 使用时间聚合
  - 缓存优化

### 4. 配置管理 (config.go - 100行)
- **配置结构** (30行)
  - 监控间隔设置
  - 数据库路径配置
  - 默认值处理
  
- **配置加载** (40行)
  - YAML文件读取
  - 环境变量支持
  - 配置验证
  
- **动态配置** (30行)
  - 运行时配置更新
  - 配置热重载
  - 配置备份

## 技术架构

### 核心依赖
- `github.com/shirou/gopsutil/v3` - 跨平台进程监控
- `github.com/mattn/go-sqlite3` - SQLite数据库
- `gopkg.in/yaml.v2` - 配置文件解析

### 数据流
```
进程扫描 → 数据过滤 → 分类识别 → 存储入库 → 聚合统计 → 报告生成
```

### 关键技术点
- **性能优化**: 5秒扫描间隔，批量插入，索引优化
- **数据准确性**: 进程名标准化，重复数据去重
- **兼容性**: Linux服务器环境，无X11依赖

## 部署要求

### 系统要求
- Linux操作系统
- Go 1.21+
- SQLite3

### 安装方式
- 单文件二进制
- systemd服务（可选）
- 手动运行

### 配置文件
```yaml
interval: 5s
database_path: "~/.process-tracker.db"
log_level: "info"
```

## 开发优先级

### Phase 1: 基础监控 (500行)
- 进程扫描和数据收集
- 基础存储功能
- 简单CLI命令

### Phase 2: 报告系统 (300行)  
- 时间统计计算
- 报告格式化输出
- 配置管理

### Phase 3: 完善优化 (200行)
- 性能优化
- 错误处理
- 部署脚本

## 风险评估

### 技术风险
- 进程监控准确性 (中)
- 数据库性能瓶颈 (低)
- 跨平台兼容性 (低)

### 缓解措施
- 充分测试不同进程类型
- 使用数据库索引优化查询
- 专注Linux平台

## 成功指标
- 准确监控进程使用时间
- 生成可读性强的报告
- 系统资源占用合理
- 安装使用简单